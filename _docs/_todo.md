implement logic for database caching